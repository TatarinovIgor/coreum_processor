[
  {
    "id": "ui-policy",
    "issuer": "https://my-auth-server.com",
    "match": {
      "methods": [
        "GET",
        "OPTIONS"
      ],
      "url": "http://<127.0.0.1|localhost>:4455/<.*>"
    },
    "upstream": {
      "url": "http://coreum-processing:9090"
    },
    "authenticators": [
      {
        "handler": "anonymous"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "noop"
      }
    ],
    "errors": [
    ]
  },
  {
    "id": "kratos-policy",
    "issuer": "https://my-auth-server.com",
    "match": {
      "methods": [
        "GET",
        "POST",
        "PUT",
        "OPTIONS"
      ],
      "url": "http://<127.0.0.1|localhost>:9090/self-service/<.*>"
    },
    "upstream": {
      "url": "http://host.docker.internal:4433"
    },
    "authenticators": [
      {
        "handler": "anonymous"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "noop"
      }
    ],
    "errors": [
    ]
  },
  {
    "id": "crm-policy-about",
    "issuer": "https://my-auth-server.com",
    "match": {
      "methods": [
        "GET",
        "OPTIONS"
      ],
      "url": "http://<127.0.0.1|localhost>:4455/crm/api/v1/<about|docs|public>/<.*>"
    },
    "upstream": {
      "url": "http://birdhouse-crm:9119"
    },
    "authenticators": [
      {
        "handler": "anonymous"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "noop"
      }
    ],
    "errors": [
    ]
  },
  {
    "id": "crm-policy-users",
    "issuer": "https://my-auth-server.com",
    "match": {
      "methods": [
        "GET",
        "POST",
        "PUT",
        "OPTIONS"
      ],
      "url": "http://<127.0.0.1|localhost>:4455/crm/api/v1/<users|partners|clients|agents>/<.*>"
    },
    "upstream": {
      "url": "http://birdhouse-crm:9119"
    },
    "authenticators": [
      {
        "handler": "cookie_session"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "id_token",
        "config": {
        }
      }
    ],
    "errors": [
      {
        "handler": "redirect",
        "config": {
          "to": "http://127.0.0.1:4439/login",
          "return_to_query_param": "return_to",
          "code": 302,
          "when": [
            {
              "error": [
                "unauthorized"
              ]
            }
          ]
        }
      }
    ]
  },
  {
    "id": "crm-policy-commerce",
    "issuer": "https://my-auth-server.com",
    "match": {
      "methods": [
        "GET",
        "POST",
        "PUT",
        "OPTIONS"
      ],
      "url": "http://<127.0.0.1|localhost>:4455/crm/api/v1/<goods|services|products>/<.*>"
    },
    "upstream": {
      "url": "http://birdhouse-crm:9119"
    },
    "authenticators": [
      {
        "handler": "cookie_session"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "id_token",
        "config": {
        }
      }
    ],
    "errors": [
    ]
  },
  {
    "id": "crm-policy-merchant",
    "issuer": "https://my-auth-server.com",
    "match": {
      "methods": [
        "GET",
        "POST",
        "PUT",
        "OPTIONS"
      ],
      "url": "http://<127.0.0.1|localhost>:4455/crm/api/v1/merchants/<.*>"
    },
    "upstream": {
      "url": "http://birdhouse-crm:9119"
    },
    "authenticators": [
      {
        "handler": "cookie_session"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "id_token",
        "config": {
          "claims": "{\"abc\": \"test-claims\"}"
        }
      }
    ],
    "errors": [
    ]
  },
  {
    "id": "crm-policy-images",
    "issuer": "https://my-auth-server.com",
    "match": {
      "methods": [
        "GET",
        "POST",
        "PUT",
        "OPTIONS"
      ],
      "url": "http://<127.0.0.1|localhost>:4455/crm/api/v1/images/<.*>"
    },
    "upstream": {
      "url": "http://birdhouse-crm:9119"
    },
    "authenticators": [
      {
        "handler": "cookie_session"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "id_token",
        "config": {}
      }
    ],
    "errors": []
  },
  {
    "id": "crm-policy-commerce",
    "issuer": "https://my-auth-server.com",
    "match":{
      "methods": ["GET", "POST", "PUT", "OPTIONS"],
      "url": "http://<127.0.0.1|localhost>:4455/crm/api/v1/transactions/<good|service|products>/<.*>"
    },
    "upstream": {
      "url": "http://host.docker.internal:9009"
    },
    "authenticators": [
      {
        "handler": "cookie_session"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "id_token",
        "config" : {
        }
      }
    ],
    "errors": [
    ]
  }
]